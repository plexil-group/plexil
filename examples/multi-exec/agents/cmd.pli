;; File: $SVNROOT/examples/multi-exec/agents/cmd.pli

(plexil-plan
  (declarations
    (library-node-declaration "get-real" (inout (string "name") (string "type") (real "real")))
    (library-node-declaration "get-int" (inout (string "name") (string "type") (integer "int"))))
  (sequence "cmd"
    (variables (string "name" "cmd")
               (real "lat" 0.0)
               (real "lon" 0.0)
               (integer "alt" 0))
    (sequence "get-aircraft-state"
      (command "print" "\n[" (stringvar "name") "] getting current state\n")
      (library-call-node "get-lat"
        (call "get-real" (alias "name" (stringvar "name")) (alias "type" "lat") (alias "real" (realvar "lat"))))
      (library-call-node "get-lon"
        (call "get-real" (alias "name" (stringvar "name")) (alias "type" "lon") (alias "real" (realvar "lon"))))
      (library-call-node "get-alt"
        (call "get-int" (alias "name" (stringvar "name")) (alias "type" "alt") (alias "int" (intvar "alt")))))
    (command "print" "[" (stringvar "name") "] recv: " (realvar "lat") " " (realvar "lon") " " (intvar "alt") "\n")
    (action "Quit"
      (command "print" "[" (stringvar "name") "] sending Quit (and quitting)\n")
      (command "SendMessage" "Quit"))))

;; EOF
