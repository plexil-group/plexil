;; File: $SVNROOT/examples/multi-exec/agents/sim.pli

(plexil-plan
  (concurrently "rover"
    (variables
      (string "name" "rover")
      (real-array "actual" 4) ;dist(ft) alt(ft) speed(ft/s) angle(deg)
      (boolean "debug" true))
    (invariant-condition (not (finished "QuitCommand")))
    ;; Announce that we are up and running
    (command "print" "\n\n[" (stringvar "name") "] is up and running...\n\n")
    ;; Handle incoming telemetry
    (sequence "recv-telemetry"
      (repeat-condition true)
      (on-command "broadcast-telemetry" ((real-array "return" 4))
        (assignment (arrayvar "actual") (arrayvar "return")))
      (command "print" "[" (stringvar "name") "] recv: " (arrayvar "actual") "\n"))
    (action "QuitCommand"
      (on-message "Quit"
        (command "print" "[" (stringvar "name") "] recv: Quit (quitting)\n\n")))))

;; EOF
