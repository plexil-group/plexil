;; File: $SVNROOT/examples/multi-exec/agents/sim.pli

(plexil-plan
  (declarations
    (library-node-declaration "state-request"))
  (concurrently "sim"
    (variables
      (string "name" "sim")
      (real-array "states" 4 70000.0 2000.0 250.0 0.0) ;dist(ft) alt(ft) speed(kts) angle(deg)
      (boolean "debug" true))
    (invariant-condition (not (finished "QuitCommand")))
    (comment "Handle commands to set the current state.  Only alt, speed and angle can be commanded.")
    (comment "Send the current state out on request")
    (action "state-request-monitor"
      (repeat-condition true)
      (library-call-node (call "state-request"
                               (alias "states" (arrayvar "states"))
                               (alias "name" (stringvar "name"))
                               (alias "debug" (boolvar "debug")))))
    (action "QuitCommand"
      (on-message "Quit"
        (command "print" "[" (stringvar "name") "] recv: Quit (quitting)\n\n")))))

;; EOF
