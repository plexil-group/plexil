<PlexilPlan LineNo="1" ColNo="5">
    <GlobalDeclarations LineNo="1" ColNo="5">
        <StateDeclaration LineNo="1" ColNo="5">
            <Name>time</Name>
            <Return>
                <Name>_return_0</Name>
                <Type>Date</Type>
            </Return>
        </StateDeclaration>
        <CommandDeclaration LineNo="2" ColNo="0">
            <Name>pprint</Name>
        </CommandDeclaration>
    </GlobalDeclarations>
    <Sequence LineNo="6" ColNo="4">
        <NodeId>TimedIteration</NodeId>
        <VariableDeclarations>
            <DeclareVariable LineNo="6" ColNo="4">
                <Name>run_start_time</Name>
                <Type>Date</Type>
            </DeclareVariable>
            <DeclareVariable LineNo="7" ColNo="4">
                <Name>earliest_start</Name>
                <Type>Date</Type>
                <InitialValue>
                    <DateValue>2012-02-23T22:21:00.000</DateValue>
                </InitialValue>
            </DeclareVariable>
            <DeclareVariable LineNo="8" ColNo="4">
                <Name>latest_start</Name>
                <Type>Date</Type>
            </DeclareVariable>
            <DeclareVariable LineNo="9" ColNo="4">
                <Name>period</Name>
                <Type>Duration</Type>
                <InitialValue>
                    <DurationValue>PT0.5S</DurationValue>
                </InitialValue>
            </DeclareVariable>
            <DeclareVariable LineNo="10" ColNo="4">
                <Name>elapsed_time</Name>
                <Type>Duration</Type>
                <InitialValue>
                    <DurationValue>PT0.0S</DurationValue>
                </InitialValue>
            </DeclareVariable>
            <DeclareVariable LineNo="11" ColNo="4">
                <Name>start_delta</Name>
                <Type>Duration</Type>
            </DeclareVariable>
            <DeclareVariable LineNo="12" ColNo="4">
                <Name>run_length</Name>
                <Type>Duration</Type>
                <InitialValue>
                    <DurationValue>PT10.0S</DurationValue>
                </InitialValue>
            </DeclareVariable>
            <DeclareVariable LineNo="13" ColNo="4">
                <Name>tolerance</Name>
                <Type>Duration</Type>
                <InitialValue>
                    <DurationValue>PT0.01S</DurationValue>
                </InitialValue>
            </DeclareVariable>
            <DeclareVariable LineNo="14" ColNo="4">
                <Name>continue</Name>
                <Type>Boolean</Type>
                <InitialValue>
                    <BooleanValue>true</BooleanValue>
                </InitialValue>
            </DeclareVariable>
        </VariableDeclarations>
        <Sequence LineNo="19" ColNo="8">
            <NodeId>SetupTimes</NodeId>
            <Node LineNo="19" ColNo="8" NodeType="Assignment">
                <NodeId>ASSIGNMENT__0</NodeId>
                <NodeBody>
                    <Assignment>
                        <DateVariable>run_start_time</DateVariable>
                        <NumericRHS>
                            <Lookup LineNo="19" ColNo="25">
                                <Name>
                                    <StringValue>time</StringValue>
                                </Name>
                            </Lookup>
                        </NumericRHS>
                    </Assignment>
                </NodeBody>
            </Node>
            <Node LineNo="20" ColNo="8" NodeType="Assignment">
                <NodeId>ASSIGNMENT__1</NodeId>
                <NodeBody>
                    <Assignment>
                        <DurationVariable>start_delta</DurationVariable>
                        <NumericRHS>
                            <SUB LineNo="20" ColNo="37">
                                <DateVariable>earliest_start</DateVariable>
                                <DateVariable>run_start_time</DateVariable>
                            </SUB>
                        </NumericRHS>
                    </Assignment>
                </NodeBody>
            </Node>
            <Node LineNo="21" ColNo="8" NodeType="Assignment">
                <NodeId>ASSIGNMENT__2</NodeId>
                <NodeBody>
                    <Assignment>
                        <DateVariable>latest_start</DateVariable>
                        <NumericRHS>
                            <ADD LineNo="21" ColNo="38">
                                <DateVariable>earliest_start</DateVariable>
                                <DurationValue>PT4.0S</DurationValue>
                            </ADD>
                        </NumericRHS>
                    </Assignment>
                </NodeBody>
            </Node>
            <Node LineNo="22" ColNo="8" NodeType="Assignment">
                <NodeId>ASSIGNMENT__3</NodeId>
                <NodeBody>
                    <Assignment>
                        <DurationVariable>run_length</DurationVariable>
                        <NumericRHS>
                            <ADD LineNo="22" ColNo="32">
                                <DurationVariable>run_length</DurationVariable>
                                <DurationVariable>start_delta</DurationVariable>
                            </ADD>
                        </NumericRHS>
                    </Assignment>
                </NodeBody>
            </Node>
        </Sequence>
        <Node LineNo="25" ColNo="4" NodeType="Command">
            <NodeId>COMMAND__4</NodeId>
            <NodeBody>
                <Command>
                    <Name>
                        <StringValue>pprint</StringValue>
                    </Name>
                    <Arguments LineNo="25" ColNo="12">
                        <StringValue>Earliest start time is in</StringValue>
                        <DurationVariable>start_delta</DurationVariable>
                        <StringValue>seconds...</StringValue>
                    </Arguments>
                </Command>
            </NodeBody>
        </Node>
        <Node LineNo="33" ColNo="8" NodeType="Command">
            <NodeId>waitForStartTime</NodeId>
            <StartCondition LineNo="30" ColNo="8">
                <LT LineNo="30" ColNo="29">
                    <DateVariable>earliest_start</DateVariable>
                    <Lookup LineNo="30" ColNo="31">
                        <Name>
                            <StringValue>time</StringValue>
                        </Name>
                    </Lookup>
                </LT>
            </StartCondition>
            <InvariantCondition LineNo="31" ColNo="8">
                <LT LineNo="31" ColNo="31">
                    <Lookup LineNo="31" ColNo="18">
                        <Name>
                            <StringValue>time</StringValue>
                        </Name>
                    </Lookup>
                    <DateVariable>latest_start</DateVariable>
                </LT>
            </InvariantCondition>
            <NodeBody>
                <Command>
                    <Name>
                        <StringValue>pprint</StringValue>
                    </Name>
                    <Arguments LineNo="33" ColNo="16">
                        <StringValue>Plan starting...</StringValue>
                    </Arguments>
                </Command>
            </NodeBody>
        </Node>
        <Sequence LineNo="38" ColNo="8">
            <NodeId>periodicIteration</NodeId>
            <VariableDeclarations>
                <DeclareVariable LineNo="38" ColNo="8">
                    <Name>iteration_start_time</Name>
                    <Type>Date</Type>
                </DeclareVariable>
            </VariableDeclarations>
            <RepeatCondition LineNo="39" ColNo="8">
                <BooleanVariable>continue</BooleanVariable>
            </RepeatCondition>
            <StartCondition LineNo="41" ColNo="8">
                <LT LineNo="41" ColNo="59">
                    <MOD LineNo="41" ColNo="47">
                        <SUB LineNo="41" ColNo="29">
                            <Lookup LineNo="41" ColNo="16">
                                <Name>
                                    <StringValue>time</StringValue>
                                </Name>
                            </Lookup>
                            <DateVariable>run_start_time</DateVariable>
                        </SUB>
                        <DurationVariable>period</DurationVariable>
                    </MOD>
                    <MUL LineNo="41" ColNo="70">
                        <DurationVariable>tolerance</DurationVariable>
                        <IntegerValue>2</IntegerValue>
                    </MUL>
                </LT>
            </StartCondition>
            <Node LineNo="43" ColNo="8" NodeType="Assignment">
                <NodeId>ASSIGNMENT__6</NodeId>
                <NodeBody>
                    <Assignment>
                        <DateVariable>iteration_start_time</DateVariable>
                        <NumericRHS>
                            <Lookup LineNo="43" ColNo="31">
                                <Name>
                                    <StringValue>time</StringValue>
                                </Name>
                            </Lookup>
                        </NumericRHS>
                    </Assignment>
                </NodeBody>
            </Node>
            <Node LineNo="44" ColNo="8" NodeType="Assignment">
                <NodeId>ASSIGNMENT__7</NodeId>
                <NodeBody>
                    <Assignment>
                        <DurationVariable>elapsed_time</DurationVariable>
                        <NumericRHS>
                            <SUB LineNo="44" ColNo="44">
                                <DateVariable>iteration_start_time</DateVariable>
                                <DateVariable>run_start_time</DateVariable>
                            </SUB>
                        </NumericRHS>
                    </Assignment>
                </NodeBody>
            </Node>
            <Node LineNo="45" ColNo="8" NodeType="Command">
                <NodeId>COMMAND__8</NodeId>
                <NodeBody>
                    <Command>
                        <Name>
                            <StringValue>pprint</StringValue>
                        </Name>
                        <Arguments LineNo="45" ColNo="16">
                            <StringValue>elapsed_time: </StringValue>
                            <DurationVariable>elapsed_time</DurationVariable>
                        </Arguments>
                    </Command>
                </NodeBody>
            </Node>
            <Wait LineNo="47" ColNo="18">
                <NodeId>WaitABit</NodeId>
                <Units>
                    <RealValue>2</RealValue>
                </Units>
            </Wait>
            <Sequence LineNo="50" ColNo="12">
                <NodeId>ConditionallyEndIteration</NodeId>
                <SkipCondition LineNo="50" ColNo="12">
                    <LE LineNo="50" ColNo="30">
                        <DurationVariable>elapsed_time</DurationVariable>
                        <DurationVariable>run_length</DurationVariable>
                    </LE>
                </SkipCondition>
                <Node LineNo="52" ColNo="12" NodeType="Assignment">
                    <NodeId>ASSIGNMENT__9</NodeId>
                    <NodeBody>
                        <Assignment>
                            <BooleanVariable>continue</BooleanVariable>
                            <BooleanRHS>
                                <BooleanValue>false</BooleanValue>
                            </BooleanRHS>
                        </Assignment>
                    </NodeBody>
                </Node>
                <Node LineNo="53" ColNo="12" NodeType="Command">
                    <NodeId>COMMAND__10</NodeId>
                    <NodeBody>
                        <Command>
                            <Name>
                                <StringValue>pprint</StringValue>
                            </Name>
                            <Arguments LineNo="53" ColNo="20">
                                <StringValue>Ending periodic iteration</StringValue>
                            </Arguments>
                        </Command>
                    </NodeBody>
                </Node>
            </Sequence>
        </Sequence>
    </Sequence>
</PlexilPlan>
